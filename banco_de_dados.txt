CREATE DATABASE puc_inside;

CREATE TABLE usuario (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(50) NOT NULL,
    email VARCHAR(50) NOT NULL UNIQUE,
    senha VARCHAR(255) NOT NULL,
    tipo VARCHAR(10) DEFAULT 'aluno',
    data_cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    curso VARCHAR(70),
    foto_perfil VARCHAR(255) NULL
);

CREATE TABLE postagem (
    id INT PRIMARY KEY AUTO_INCREMENT,
    conteudo TEXT NOT NULL,
    data_postagem TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    qtde_gostei INT DEFAULT 0,
    
    id_usuario INT NOT NULL,
    FOREIGN KEY (id_usuario) REFERENCES usuario(id)
);

CREATE TABLE comentario (
    id INT PRIMARY KEY AUTO_INCREMENT,
    assunto TEXT NOT NULL,
    data_comentario TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    id_usuario INT NOT NULL, 
    id_postagem INT NOT NULL, 
    FOREIGN KEY (id_usuario) REFERENCES usuario(id),
    FOREIGN KEY (id_postagem) REFERENCES postagem(id)
);

CREATE TABLE midia (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome_arquivo VARCHAR(255) NOT NULL,
    tipo VARCHAR(50), 
    tamanho_bytes INT,
    
    id_postagem INT NOT NULL,
    FOREIGN KEY (id_postagem) REFERENCES postagem(id)
);

CREATE TABLE seguidor (
    id_seguidor INT NOT NULL,
    id_seguido INT NOT NULL,
    data_seguir TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (id_seguidor) REFERENCES usuario(id),
    FOREIGN KEY (id_seguido) REFERENCES usuario(id),
    
    PRIMARY KEY (id_seguidor, id_seguido)
);

CREATE TABLE likes (
    id_usuario INT NOT NULL,
    id_postagem INT NOT NULL,
    
    FOREIGN KEY (id_usuario) REFERENCES usuario(id),
    FOREIGN KEY (id_postagem) REFERENCES postagem(id),
    
    PRIMARY KEY (id_usuario, id_postagem)
);